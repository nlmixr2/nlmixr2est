<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • nlmixr2est</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://nlmixr2.github.io/nlmixr2est/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2est</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2est/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/nlmixr2/nlmixr2est/blob/main/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="development version" id="nlmixr2est-development-version">nlmixr2est (development version)<a class="anchor" aria-label="anchor" href="#nlmixr2est-development-version"></a></h2>
<ul><li><p>Fix scale.h so that <code>scaleType="none"</code> does not also require <code>scaleTo=0</code></p></li>
<li><p>Request Armadillo 15 with the special flag in the new <code>RcppArmadillo</code></p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.1.0" id="nlmixr2est-410">nlmixr2est 4.1.0<a class="anchor" aria-label="anchor" href="#nlmixr2est-410"></a></h2><p class="text-muted">CRAN release: 2025-08-29</p>
<ul><li><p>Updated inferring the estimation method from the control object. Requires the control object to have a class of length one and match the estimation method. For example <code><a href="../reference/foceiControl.html">foceiControl()</a></code> would assume that the estimation method is related to <code>focei</code>.</p></li>
<li><p>Changed Rstudio completion to not evaluate (in case it gets turned on for data.frames) (See <a href="https://github.com/nlmixr2/nlmixr2est/issues/568" class="external-link">#568</a>)</p></li>
<li><p>Turned on data completion for items like <code>$fitMergeInner</code></p></li>
<li><p><strong>Breaking change:</strong> Changed the estimation method <code>posthoc</code> to add tables and calculate the covariance by default. It is now a method with it’s own control, <code><a href="../reference/posthocControl.html">posthocControl()</a></code>. As previously the default is not to include the interaction term (but you can turn it on with <code>posthocControl(interaction=TRUE)</code>).</p></li>
<li><p>Added <code><a href="../reference/foceControl.html">foceControl()</a></code>, <code><a href="../reference/foControl.html">foControl()</a></code> and <code><a href="../reference/foiControl.html">foiControl()</a></code> for the <code>foce</code>, <code>fo</code> and <code>foi</code> methods, respectively. They try to convert the related control structures to the correct control structure for the estimation method.</p></li>
<li><p>Added iov support for <code>focei</code>, <code>foce</code>, and <code>saem</code> (<a href="https://github.com/nlmixr2/nlmixr2est/issues/614" class="external-link">#614</a>)</p></li>
<li><p>Added new estimation method <code>agq</code> which uses adaptive Gauss-Hermite Quadrature to fit a nonlinear-mixed effect model. In this method, you can choose the number of quadrature points to estimate the likelihood, with higher numbers giving more accurate likelihoods. The AGQ implementation in nlmixr2est allows you to specify the number of quadrature points via the <code><a href="../reference/agqControl.html">agqControl()</a></code> function, and supports both single and multiple subject models. This method is particularly useful for models where accurate likelihood estimation is critical.</p></li>
<li><p>Also added a <code>laplace</code> method which is the same as <code>agq</code> with 1 node (and is numerically the same as <code>focei</code>, <code>foce</code> or log-likelihood <code>focei</code>/<code>laplace</code>, etc), but uses the <code>agq</code> routine.</p></li>
<li><p>Fixed saem mu-reference display by not compressing the internal item <code>saem0</code>.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.0.2" id="nlmixr2est-402">nlmixr2est 4.0.2<a class="anchor" aria-label="anchor" href="#nlmixr2est-402"></a></h2><p class="text-muted">CRAN release: 2025-07-24</p>
<ul><li><p>The loading and unloading of DLLs has been minimized in this version of nlmixr2est. This avoids loading/reloading the same DLLs and causing the CRAN mac m1 ASAN/USBAN false positive issue observed in CRAN.</p></li>
<li><p>Additionally a new function <code>nlmixr2fix(fit)</code> has been added to <code>nlmixr2est</code>. It attempts to make the fit loaded from a different version of nlmixr2 compatible with nlmixr2 4.0. It also prints out the versions of <code>nlmixr2</code> that were used when creating this fit. With this information you are more likely to find a way to use the fit in your current session (or in an old session). (Issue <a href="https://github.com/nlmixr2/nlmixr2est/issues/562" class="external-link">#562</a>)</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.0.1" id="nlmixr2est-401">nlmixr2est 4.0.1<a class="anchor" aria-label="anchor" href="#nlmixr2est-401"></a></h2><p class="text-muted">CRAN release: 2025-07-19</p>
<ul><li>Initialize lbfgsb3 error message to an empty string to address valgrind finding (as requested by CRAN).</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="4.0.0" id="nlmixr2est-400">nlmixr2est 4.0.0<a class="anchor" aria-label="anchor" href="#nlmixr2est-400"></a></h2><p class="text-muted">CRAN release: 2025-07-15</p>
<ul><li><p>When using a model to start a new focei model, the ETAs from the last fit are used as the starting point. Now you can use <code>foceiControl(etaMat=NA)</code> to skip this and use <code>eta=0</code> for all items.</p></li>
<li><p>When using <code>foceiControl(etaMat=fit)</code>, this will extract the ETAs from a fit for use in the next optimization.</p></li>
<li><p>When using a <code>foceiControl(etaMat=)</code> option nlmixr2 no longer only evaluates the inner problem with the <code>etaMat</code> value.</p></li>
<li>
<p>Add <code>mceta</code> option to <code>"focei"</code>.</p>
<ul><li>
<code>mceta=-1</code> is the default; the eta restarts at the best eta from the last step to start the inner optimization.</li>
<li>
<code>mceta=0</code> the eta starts at <code>0</code> to start the inner optimization.</li>
<li>
<code>mceta=1</code> the eta starts at either <code>0</code> or the best <code>eta</code>, which ever gives the lowest objective function to start the inner optimization.</li>
<li>
<code>mceta=n</code> under the assumption of <code>omega</code> sample <code>n-1</code> <code>eta</code> values and use the lowest objective function of eta sampled, last best eta and eta=0 to start the inner optimization.</li>
</ul></li>
<li><p>Fix Rstudio print (issue <a href="https://github.com/nlmixr2/nlmixr2est/issues/536" class="external-link">#536</a>)</p></li>
<li><p>Support rxode2’s new <code>+var()</code> definition in <code>saem</code></p></li>
<li><p>Support literal fixing of residuals (<a href="https://github.com/nlmixr2/nlmixr2est/issues/524" class="external-link">#524</a>). All methods that support a literal fix of residuals have an option <code>literalFixRes</code> which defaults to <code>TRUE</code>. To get the behavior from older models you can use <code>literalFixRes=FALSE</code></p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.4" id="nlmixr2est-304">nlmixr2est 3.0.4<a class="anchor" aria-label="anchor" href="#nlmixr2est-304"></a></h2><p class="text-muted">CRAN release: 2025-02-18</p>
<ul><li><p>More robust covariance calculation in <code>focei</code>.</p></li>
<li><p>Allow hook mechanism to handle piped arguments.</p></li>
<li><p>Fix for when output message from optimizing doesn’t print well (<a href="https://github.com/nlmixr2/nlmixr2est/issues/325" class="external-link">#325</a>)</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.3" id="nlmixr2est-303">nlmixr2est 3.0.3<a class="anchor" aria-label="anchor" href="#nlmixr2est-303"></a></h2><p class="text-muted">CRAN release: 2025-01-18</p>
<ul><li><p>Moved data check for covariates and required data items to a pre-processing step. This fixes <a href="https://github.com/nlmixr2/nlmixr2est/issues/499" class="external-link">#499</a>. Each method that needs to have a covariate check needs to have a property <code>covPresent</code>. For example to apply the covariate data check to the <code>focei</code> method you need <code>attr(nlmixr2Est.focei, "covPresent") &lt;- TRUE</code>.</p></li>
<li><p>Bug fix for non-mu referenced etas when combined with mu referenced covariate values. (See <a href="https://github.com/nlmixr2/nlmixr2est/issues/498" class="external-link">#498</a>)</p></li>
<li><p>Changed option for <code>"saem"</code> to have <code>literalFix=FALSE</code>. This makes mu-referencing work better when fixing a population value.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.2" id="nlmixr2est-302">nlmixr2est 3.0.2<a class="anchor" aria-label="anchor" href="#nlmixr2est-302"></a></h2><p class="text-muted">CRAN release: 2024-11-23</p>
<ul><li><p>Fix bug where models where omega boundary warnings caused problems in estimation (<a href="https://github.com/nlmixr2/nlmixr2est/issues/490" class="external-link">#490</a>)</p></li>
<li><p>Created a new api for pre-processing ui, allowing adding arbitrary hooks. As written now, this includes literal fix and zero omega as well as added the new rxode2 ui processing.</p></li>
<li><p>Fixed compilation to only use -I in most systems for maximum compatibility</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.1" id="nlmixr2est-301">nlmixr2est 3.0.1<a class="anchor" aria-label="anchor" href="#nlmixr2est-301"></a></h2><p class="text-muted">CRAN release: 2024-10-22</p>
<div class="section level3">
<h3 id="new-features-3-0-1">New features<a class="anchor" aria-label="anchor" href="#new-features-3-0-1"></a></h3>
<ul><li><p>Now when optimizing only a single parameter with <code>focei</code>-family, will change to use <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">stats::optimize()</a></code> for the outer problem (<a href="https://github.com/nlmixr2/nlmixr2est/issues/481" class="external-link">#481</a>)</p></li>
<li><p>When estimating with all fixed population parameters, do a posthoc estimation.</p></li>
<li><p>Internally removed <code><a href="https://rdrr.io/r/utils/getFromNamespace.html" class="external-link">assignInMyNamespace()</a></code> replacing with <code>nlmixr2global</code>, which fixes some edge case bugs where the nlmixr2 environment was not reset properly.</p></li>
<li><p>Treated edge case where all initial parameters are zero and change scaling from scaled to unscaled (<a href="https://github.com/nlmixr2/nlmixr2est/issues/486" class="external-link">#486</a>)</p></li>
<li><p>Added <code>mu</code>4 referencing that will change string expressions to <code>rxode2</code> numeric values. This allows derived strings to also be treated as <code>mu</code> expressions (<a href="https://github.com/nlmixr2/nlmixr2est/issues/484" class="external-link">#484</a>)</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-3-0-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-3-0-1"></a></h3>
<ul><li>Fix <code>focei</code> covariance step when many <code>omega</code> values are fixed <a href="https://github.com/nlmixr2/nlmixr2est/issues/482" class="external-link">#482</a></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="3.0.0" id="nlmixr2est-300">nlmixr2est 3.0.0<a class="anchor" aria-label="anchor" href="#nlmixr2est-300"></a></h2><p class="text-muted">CRAN release: 2024-09-18</p>
<ul><li><p>No binary linking to <code>rxode2</code>, <code>lbfgsb3c</code> and <code>n1q1</code>, which means that updating these will not make <code>nlmixr2est</code> crash without recompiling.</p></li>
<li><p>New <code>mu</code>3 referencing will take context from the model to see if the algebraic expression can be completed from defined model variables; These variable would have to be unique.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.2.2" id="nlmixr2est-222">nlmixr2est 2.2.2<a class="anchor" aria-label="anchor" href="#nlmixr2est-222"></a></h2><p class="text-muted">CRAN release: 2024-05-28</p>
<div class="section level3">
<h3 id="breaking-changes-2-2-2">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-2-2-2"></a></h3>
<ul><li><p>Saem non-mu reference input parameters/covariates were fixed so they work correctly with fixed parameters (Issue <a href="https://github.com/nlmixr2/nlmixr2est/issues/445" class="external-link">#445</a>)</p></li>
<li><p>Focei changed back to having a lower bound for standard deviations when not specified. This means that best model fits may change. You can revert to the old settings by using <code>foceiControl(sdLowerFact=0.0)</code>. You can also change the factors to other values than the default value, that is <code>foceiControl(sdLowerFact=0.000001)</code> for instance which would multiply the initial value by <code>0.000001</code> when either the lower bound isn’t specified or the lower bound is specified as zero for the error estimates related to error-based standard deviations.</p></li>
<li>
<p>In <code>nlmixr2</code>, expressions are optimized. Because of that optimization, numerical rounding differences can cause different directions in optimization when fixing parameters in the model vs. fixing the parameters manually.</p>
<p>This means that the fixed parameters in a model vs hard-coded fixed parameters could give different values in the final model.</p>
<p>A new option <code>literalFix</code> was introduced which change the fixed population parameters to constants in the model while running the optimization. This makes the output of fixing within the model and fixing manually the same (which is what is likely expected). The default is for this to be turned on (ie. <code>literalFix=TRUE</code>). You can get back the old behavior by using the option <code>literalFix=FALSE</code>.</p>
</li>
<li><p>In <code>saem</code>, the monte-carlo sampling occurs for all parameters including non-informative ETAs. A fix ensure that non-informative etas in <code>saem</code> are fixed to zero while sampling the <code>phi</code> values. This may change results for models with uninformative etas. To ignore the uninformative etas with <code>saem</code> you ca use use the prior <code>saem</code> handling with <code>saemControl(handleUninformativeEtas=FALSE)</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-2-2-2">New features<a class="anchor" aria-label="anchor" href="#new-features-2-2-2"></a></h3>
<ul><li><p>Gracefully degrade when $cov is not in the right form (see <a href="https://github.com/nlmixr2/nlmixr2est/issues/423" class="external-link">#423</a>)</p></li>
<li><p>Add support for PopED in place solving (used in babelmixr2)</p></li>
<li><p>If <code>est=foceiControl()</code> or other nlmixr2 control with the class <code>foceiControl</code> infer the estimation method is <code>focei</code></p></li>
<li><p>Add back the warnings when estimation methods ignore the boundaries</p></li>
<li><p>When using <code>rxSolve</code>, now respects the values from <code><a href="../reference/tableControl.html">tableControl()</a></code> (<a href="https://github.com/nlmixr2/nlmixr2est/issues/465" class="external-link">#465</a> and <a href="https://github.com/nlmixr2/nlmixr2est/issues/297" class="external-link">#297</a>)</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-2-2-2">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-2-2"></a></h3>
<ul><li>Will emit warnings when the return object is not a nlmixr2 fit (<a href="https://github.com/nlmixr2/nlmixr2est/issues/453" class="external-link">#453</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="other-things-2-2-2">Other things<a class="anchor" aria-label="anchor" href="#other-things-2-2-2"></a></h3>
<ul><li>Moved actual code of some matrix libraries to <code>lotri</code> and import them via function pointers</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.2.1" id="nlmixr2est-221">nlmixr2est 2.2.1<a class="anchor" aria-label="anchor" href="#nlmixr2est-221"></a></h2><p class="text-muted">CRAN release: 2024-01-31</p>
<ul><li>Align with the possibility that linCmt sensitivities may not be present (like intel c++)</li>
</ul><div class="section level3">
<h3 id="bug-fix-2-2-1">Bug fix<a class="anchor" aria-label="anchor" href="#bug-fix-2-2-1"></a></h3>
<ul><li>
<code>focei</code> cache needs to be based on the parameter order as well as the model information (<a href="https://github.com/nlmixr2/nlmixr2est/issues/415" class="external-link">#415</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.2.0" id="nlmixr2est-220">nlmixr2est 2.2.0<a class="anchor" aria-label="anchor" href="#nlmixr2est-220"></a></h2><p class="text-muted">CRAN release: 2023-12-12</p>
<div class="section level3">
<h3 id="new-features-2-2-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-2-2-0"></a></h3>
<ul><li><p>Algebraic mu referencing has been implemented in <code>nlme</code> and <code>saem</code>.</p></li>
<li><p>New estimation method “nlm” has been added to estimate population only likelihoods using <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">stats::nlm</a></code> and possibly return a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>New estimation method “nls” has been added to estimate population only problems. This uses <code>minpack.lm::nlsNM</code> by default if present, or the <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a></code></p></li>
<li><p>New estimation method “optim” has been added to estimate population only likelihoods. This uses <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> and returns a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>New estimation method “nlminb” has been added to estimate population only likelihoods. This uses <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code> and returns a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>New estimation methods from the <code>minqa</code> package: “bobyqa”, “uobyqa” and “newuoa” have been added to estimate population only likelihoods. These methods returns a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>New estimation method “lbfgsb3c” to estimate population only likelihoods. This returns a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>New estimation method “n1qn1” to estimate population only likelihoods. This returns a standardized <code>nlmixr2</code> fit.</p></li>
<li><p>Added new feature for <code><a href="../reference/vpcSim.html">vpcSim()</a></code> where a minimum number of subjects are simulated from the model when trying to fill in ODEs that were not solved successfully. By default this is <code>10</code>. This also works-around a bug when there is only one subject simulated and the <code>data.frame</code> has a slightly different output.</p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-2-2-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-2-2-0"></a></h3>
<ul><li><p>Removed <code>fit$saemTransformedData</code> since it isn’t actually used in <code>saem</code> anymore (but will break anyone’s code who is using it)</p></li>
<li><p>Now the internal function <code><a href="../reference/dot-foceiPreProcessData.html">.foceiPreProcessData()</a></code> requires the rxode2 control <code><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxControl()</a></code> because some of the new steady state lag features need to translate the data differently based on <code><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxControl()</a></code> options.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-2-2-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-2-0"></a></h3>
<ul><li><p>Printing models with correlated omega values and omega values fixed to zero no longer fails (<a href="https://github.com/nlmixr2/nlmixr2est/issues/359" class="external-link">#359</a>)</p></li>
<li><p>Add back values for $parHistData (<a href="https://github.com/nlmixr2/nlmixr2est/issues/368" class="external-link">#368</a>)</p></li>
<li><p>This requires a new <code>rxode2</code> which will fix multiple endpoint issues observed (<a href="https://github.com/nlmixr2/nlmixr2est/issues/394" class="external-link">#394</a>)</p></li>
<li><p>Manual back-transformed values in <code>$parFixed</code> are now displaying correctly and are calculated based on the confidence interval in the control instead of 95% confidence no matter what (<a href="https://github.com/nlmixr2/nlmixr2est/issues/397" class="external-link">#397</a>)</p></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-2-2-0">Other changes<a class="anchor" aria-label="anchor" href="#other-changes-2-2-0"></a></h3>
<ul><li>An <code><a href="https://nlmixr2.github.io/rxode2/reference/as.rxUi.html" class="external-link">as.rxUi()</a></code> method was added for fit models (<a href="https://github.com/nlmixr2/nlmixr2est/issues/377" class="external-link">#377</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.8" id="nlmixr2est-218">nlmixr2est 2.1.8<a class="anchor" aria-label="anchor" href="#nlmixr2est-218"></a></h2><p class="text-muted">CRAN release: 2023-10-08</p>
<ul><li>Version bump and a minor documentation update (same as nlmixr2est 2.1.7). This version bump is to simply allow correct binary linkage to rxode2 2.0.14. Otherwise <code>nlmixr2</code> models will crash R.</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.7" id="nlmixr2est-217">nlmixr2est 2.1.7<a class="anchor" aria-label="anchor" href="#nlmixr2est-217"></a></h2><p class="text-muted">CRAN release: 2023-09-18</p>
<ul><li><p>As requested by CRAN, remove <code>Rvmmin</code></p></li>
<li><p>Values in <code>$parFixed</code> for BSV without exponential transformation are now correctly shown (<a href="https://github.com/nlmixr2/nlmixr2est/issues/366" class="external-link">#366</a>)</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.6" id="nlmixr2est-216">nlmixr2est 2.1.6<a class="anchor" aria-label="anchor" href="#nlmixr2est-216"></a></h2><p class="text-muted">CRAN release: 2023-05-25</p>
<div class="section level3">
<h3 id="breaking-changes-2-1-6">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-2-1-6"></a></h3>
<ul><li>Since <code>rxode2</code> now allows simulation with <code>omega</code> having diagonal zero elements, <code>$omega</code> and <code>$omegaR</code> now reflects this information including the zero omega elements in the output. On the other hand, the other eta-information and standard error information for zero etas are still excluded in <code>$phiR</code>, <code>$phiSE</code>, <code>$eta</code> etc.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-2-1-6">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-1-6"></a></h3>
<ul><li><p><code><a href="../reference/vpcSim.html">vpcSim()</a></code> works when an eta value is fixed to 0 (<a href="https://github.com/nlmixr2/nlmixr2est/issues/341" class="external-link">#341</a>)</p></li>
<li><p><code><a href="https://rdrr.io/pkg/nlme/man/augPred.html" class="external-link">augPred()</a></code> now consistently uses the simulation model (instead of the inner model used for <code>CWRES</code> calculation).</p></li>
</ul></div>
<div class="section level3">
<h3 id="other-changes-2-1-6">Other changes<a class="anchor" aria-label="anchor" href="#other-changes-2-1-6"></a></h3>
<ul><li>Dropped dependence on orphaned package <code>ucminf</code>
</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.5" id="nlmixr2est-215">nlmixr2est 2.1.5<a class="anchor" aria-label="anchor" href="#nlmixr2est-215"></a></h2><p class="text-muted">CRAN release: 2023-04-22</p>
<ul><li><p>Add <code>$fitMergeFull</code>, <code>$fitMergInner</code>, <code>$fitMergeLeft</code>, <code>$fitMergeRight</code> as a complement to <code>$dataMergeFull</code>, <code>$dataMergInner</code>, <code>$dataMergeLeft</code>, <code>$dataMergeRight</code>. The fit variants prefer columns in the fit dataset instead of the original dataset. This is useful for goodness of fit plots with censoring since the <code>DV</code> in the fit simulates values under the ipred/residual assumption and will give more appropriate goodness of fits, otherwise these values are the limit of whatever censoring is applied</p></li>
<li><p>Moved the mu reference fix for the split mu referenced model here (from babelmixr2)</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.4" id="nlmixr2est-214">nlmixr2est 2.1.4<a class="anchor" aria-label="anchor" href="#nlmixr2est-214"></a></h2><p class="text-muted">CRAN release: 2023-04-02</p>
<ul><li><p>Breaking change, now calculate condition number based on covariance and correlation, the names have changed to be more explicit. <code>conditionNumber</code> changed to <code>conditionNumberCov</code> and a new metric <code>conditionNumberCor</code> has been added.</p></li>
<li><p>A bug in boundary value detection prevented automatic covariance calculation with FOCEi estimation (<a href="https://github.com/nlmixr2/nlmixr2est/issues/318" class="external-link">#318</a>)</p></li>
<li><p>Fix <code>vpcSim</code> so that it will be a bit more robust when it is difficult to simulate.</p></li>
<li><p>A bug in model piping which did not allow models to be appended to was fixed (rxode2#364)</p></li>
<li><p>An internal change was made in <code><a href="../reference/nlmixr2.html">nlmixr2.rxUi()</a></code> to better support the babelmixr2 PKNCA estimation method (babelmixr2#75)</p></li>
<li><p>Fixed bug where <code>$iniUi</code> did not return the initial ui when running non <code>focei</code> related methods. Also added alias of <code>$uiIni</code> to the same function.</p></li>
<li><p>Dropped Stan headers for this package, also updated to C++17</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.3" id="nlmixr2est-213">nlmixr2est 2.1.3<a class="anchor" aria-label="anchor" href="#nlmixr2est-213"></a></h2><p class="text-muted">CRAN release: 2022-11-10</p>
<ul><li><p>Allows <code>$etaH</code> and related family to be integrated into a <code>saem</code> fit if <code>cwres</code> is calculated.</p></li>
<li><p>Fixed a bug where <code>nlmixrLlikObs</code> in the merged dataset is sometimes named <code>llikObs</code>, now it is always named <code>nlmixrLlikObs</code></p></li>
<li><p>Fixed a bug where <code>nlmixrLlikObs</code> shows up in merged dataset when <code>cwres</code> is not calculated (it was always <code>0</code>), also allow <code>cwres</code> calculation to pick up <code>nlmixrLlikObs</code> in merged dataset.</p></li>
<li><p>Dropped <code>dparser</code> dependency</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.2" id="nlmixr2est-212">nlmixr2est 2.1.2<a class="anchor" aria-label="anchor" href="#nlmixr2est-212"></a></h2><p class="text-muted">CRAN release: 2022-11-02</p>
<ul><li><p>Fixes <code>$etaH</code> memory corruption so the standard errors of etas are now correct</p></li>
<li><p>Removed the memory requirements for focei by <code>neta*neta*nsub</code></p></li>
<li><p>Fixed character based covariates so the work correctly (again) with focei. Added a test for this as well.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.1" id="nlmixr2est-211">nlmixr2est 2.1.1<a class="anchor" aria-label="anchor" href="#nlmixr2est-211"></a></h2><p class="text-muted">CRAN release: 2022-10-22</p>
<ul><li><p>Fixes <code>$dataMergeInner</code> so that observation-based log-likelihoods work with infusions. Should fix tests with <code>ggPMX</code></p></li>
<li><p>Fixes <code>$etaSE</code> and <code>$etaRSE</code> to work correctly when there is only 1 eta.</p></li>
<li><p>Fixes npde valgrind observed on CRAN machines</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.0" id="nlmixr2est-210">nlmixr2est 2.1.0<a class="anchor" aria-label="anchor" href="#nlmixr2est-210"></a></h2><p class="text-muted">CRAN release: 2022-10-19</p>
<div class="section level3">
<h3 id="breaking-changes-2-1-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-2-1-0"></a></h3>
<div class="section level4">
<h4 id="focei-2-1-0">FOCEi<a class="anchor" aria-label="anchor" href="#focei-2-1-0"></a></h4>
<ul><li><p>Gill forward differences will not repeat now (by default), You can change back to prior behavior with <code>foceiControl(repeatGillMax=3)</code></p></li>
<li><p>Number of sticky recalculation is reduced to 4; to have the old behavior use <code>foceiControl(stickyRecalcN=5)</code></p></li>
<li><p><code>n2ll</code> has been changed to <code>ll</code> to specify individual log-likelihoods. This was only used in simulation and was not well documented.</p></li>
<li><p>Generalized log-likelihood is only supported with <code>rxode2</code> <code>2.0.8</code> or later.</p></li>
</ul></div>
<div class="section level4">
<h4 id="focei-covariance-calculation-2-1-0">FOCEi covariance calculation<a class="anchor" aria-label="anchor" href="#focei-covariance-calculation-2-1-0"></a></h4>
<ul><li><p>The <code>S</code> matrix calculation was made a bit more robust to errors in individual gradients. When there are errors in the individual gradient calculation, assume the gradient is the same as the overall gradient. In the tests cases, were reasonable using this adjusted S matrix. This means if some individuals do not have very much data to support a specific parameter, a <code>S</code> matrix calculation for the population will still be generated. When there is some patients/subject combinations that do not have sufficient data, we will add the following to the run information: <code>S matrix had    problems solving for some subject and parameters</code>. The <code>S</code> matrix calculation will still fail if the percentage of parameters that are being reset is lower than <code>foceiControl(smatPer=0.6)</code> or whatever you specify.</p></li>
<li><p>The <code>r,s</code> covariance matrix will now also check for unreasonably small values (controlled by <code>foceiControl(covSmall=...)</code>) and select a different covariance estimate method even when the “r” and “s” matrices are calculated “correctly”.</p></li>
</ul></div>
</div>
<div class="section level3">
<h3 id="new-features-2-1-0">New features<a class="anchor" aria-label="anchor" href="#new-features-2-1-0"></a></h3>
<ul><li><p>What type(s) censoring (if any) is now stored in <code>fit$censInformation</code></p></li>
<li><p>Standard errors of <code>$etas</code> can now be obtained with <code>fit$phiSE</code>, also available are <code>fit$phiRSE</code> (relative standard error), <code>fit$phiH</code>, (individual hessian), <code>fit$phiC</code> (individual covariances), <code>fit$phiR</code> (individual correlation matrices)</p></li>
<li><p>Can also use Shi 2021 differences in addition to Gill differences. In our tests (using the same datasets as CPT) these produced worse estimates than the Gill 1983, though it is unclear why since it should be a faster more accurate method. A modified version is used in calculating the individual Hessians of numerically for the generalized likelihood approach.</p></li>
<li><p>Generalized likelihood estimation is now present in <code>nlmixr2est</code> for <code>focei</code>, <code>foce</code> and <code>posthoc</code></p></li>
<li><p><code><a href="../reference/nmNearPD.html">nmNearPD()</a></code> is a function you may use for nearest positive definite matrix. This is derived from <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">Matrix::nearPD()</a></code> but is implemented in C/C++ to be used in (possibly threaded) optimization.</p></li>
<li><p>Individual Hessians can be accessed by <code>$phiH</code>, covariance by <code>$phiC</code>, eta standard errors by <code>$phiSE</code> and eta RSEs can be accessed by <code>$phiRSE</code>. There are <code>eta</code> aliases for these as well (<code>$etaH</code>, <code>$etaC</code>, <code>$etaSE</code>, and <code>$etaRSE</code>).</p></li>
<li>
<p>Can now access the individual point’s contribution to the overall likelihood when merging to the original dataset. These merges can be accessed with <code>$dataMergeFull</code>, <code>$dataMergeLeft</code>, <code>$dataMergeRight</code>, and <code>$dataMergeInner</code>. The columns with the individual data column is <code>nlmixrLlikObs</code>.</p>
<p>To calculate the total <code>focei</code>/<code>foce</code> objective function, the sum of the likelihoods still need to be adjusted by the omega/eta contribution, and the individual Hessians, and possibly the NONMEM objective function offset constant.</p>
</li>
</ul></div>
<div class="section level3">
<h3 id="censoring-fixes-2-1-0">Censoring fixes<a class="anchor" aria-label="anchor" href="#censoring-fixes-2-1-0"></a></h3>
<ul><li>Fixed bug where datasets with censoring that are not lower case <code>cens</code> and <code>limit</code> do not produce the correct table output (<a href="https://github.com/nlmixr2/nlmixr2est/issues/180" class="external-link">#180</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="focei-updates-2-1-0">FOCEi updates<a class="anchor" aria-label="anchor" href="#focei-updates-2-1-0"></a></h3>
<ul><li>Resets now scale properly when a value is simulated outside the limit</li>
<li>Models with zero gradients on the first step now switch to <code>bobyqa</code> by default. With this, it is more important to examine the model parameters and fits for plausibility.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.8" id="nlmixr2est-208">nlmixr2est 2.0.8<a class="anchor" aria-label="anchor" href="#nlmixr2est-208"></a></h2><p class="text-muted">CRAN release: 2022-06-22</p>
<div class="section level3">
<h3 id="new-features-2-0-8">New features<a class="anchor" aria-label="anchor" href="#new-features-2-0-8"></a></h3>
<ul><li>Add <code>pd</code>/<code>npd</code> as an output as well as <code>npd</code>/<code>npde</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="saem-bug-fix-2-0-8">SAEM bug fix<a class="anchor" aria-label="anchor" href="#saem-bug-fix-2-0-8"></a></h3>
<ul><li>When loading a <code>nlmixr2</code> “saem” fit from another R session, <code>nlmixr2</code> will no longer crash with <code>fit$objf</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="npdenpd-fixes-2-0-8">NPDE/NPD fixes<a class="anchor" aria-label="anchor" href="#npdenpd-fixes-2-0-8"></a></h3>
<ul><li>
<code>NPDE</code> was identical to <code>NPD</code> even with correlated models, this was fixed (prior output was actually <code>NPDE</code>).</li>
</ul></div>
<div class="section level3">
<h3 id="censoring-fixes-2-0-8">Censoring fixes<a class="anchor" aria-label="anchor" href="#censoring-fixes-2-0-8"></a></h3>
<ul><li>FOCEi censoring fixes:
<ul><li>M4 method equation bug fix</li>
<li>M4 method derivative change based on equation fix</li>
<li>M2 method added missing derivative</li>
<li>Censoring already dTBS</li>
</ul></li>
<li>SAEM Censoring fixes:
<ul><li>SAEM method M4 method equation bug fix</li>
<li>Censoring limit changed to dTBS</li>
</ul></li>
<li>Censoring handling was unified</li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-2-0-8">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-2-0-8"></a></h3>
<ul><li><p>Added <code>ui$getSplitMuModel</code> which is used in <code>babelmixr2</code> and will be used in the refined stepwise covariate selection of <code>nlmixr2extra</code></p></li>
<li><p>Added work-around to remove <code>_nlmixr2est_RcppExport_registerCCallable</code> since the registering of C callable are handled manually at the moment.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.7" id="nlmixr2est-207">nlmixr2est 2.0.7<a class="anchor" aria-label="anchor" href="#nlmixr2est-207"></a></h2><p class="text-muted">CRAN release: 2022-05-23</p>
<ul><li><p>Use <code>.zeros()</code> for the matrices in armadillo in addition to relying on <code>calloc</code> to give zero matrices.</p></li>
<li><p>Fixed one uninitialized object</p></li>
<li><p>Fix for <code>augPred</code> so it works on population only models</p></li>
<li><p><code>nlme</code> no longer sets options to treat all covariates as non mu-referenced covariates, but directly calls a function that can turn on or off the mu-reference covariate selection.</p></li>
<li><p><code>vpcSim</code> now tries to simulate IDs that didn’t simulate correctly (with a warning)</p></li>
<li><p>Export nmObjHandleControlObject</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.6" id="nlmixr2est-206--new-package">nlmixr2est 2.0.6 – new package<a class="anchor" aria-label="anchor" href="#nlmixr2est-206--new-package"></a></h2><p class="text-muted">CRAN release: 2022-05-12</p>
<p><code>nlmixr2est</code> contains the estimation functions within <code>nlmixr2</code>.</p>
<div class="section level3">
<h3 id="focei-family-changes-2-0-6">FOCEI family changes<a class="anchor" aria-label="anchor" href="#focei-family-changes-2-0-6"></a></h3>
<ul><li><p>Remove lower level <code>foceiFit</code> function. Focei, foce, fo, foi, and posthoc now directly takes rxode2 ui objects</p></li>
<li><p>New error types are supported in focei including mixing theta and etas in residual errors and different types of proportional errors</p></li>
<li><p>Different types of additive and proportional errors can be used for each endpoint using <code>+ combined1()</code> or <code>+ combined2()</code> otherwise it takes the supplied <code>addProp</code> option to figure out which type of combined model is run (by default <code>combined2()</code>)</p></li>
<li><p>Focei model cache is now named <code>focei-md5Digest.qs</code> and uses <code>qs</code> compression/saving/loading.</p></li>
<li><p><code><a href="../reference/foceiControl.html">foceiControl()</a></code> aligned between other methods.</p></li>
<li><p><code>foceiControl(adjLik=TRUE)</code> uses the NONMEM-style objective function throughout. <code>foceiControl(adjLik=FALSE)</code> uses the adjusted objective function throughout, and adjusts it back to the NONMEM objective function.</p></li>
<li><p>Lag time and other between subject variability differences no longer calculate an ideal relative step size, but an absolute step size when using Gill differences (default)</p></li>
<li><p>Objective function checks for infinite/NaN/NA values for the entire solving space and ensures no overflow occurs when calculating the inner hessian</p></li>
</ul></div>
<div class="section level3">
<h3 id="saem-changes-2-0-6">SAEM changes<a class="anchor" aria-label="anchor" href="#saem-changes-2-0-6"></a></h3>
<ul><li><p>mu referencing is no longer required for <code>saem</code>; Internally non mu-referenced values are converted to mu referenced values and the converted back when calculating the nlmixr2 object.</p></li>
<li>
<p><code>nlmixr2</code> forced the parameter ordering to (1) population effects,</p>
<ol start="2" style="list-style-type: decimal"><li>non mu-referenced between subject effects (3) omega estimates and (4) residual effects. This changes the order that <code>nlmixr2</code> sees the parameters. Since this is based on a random number generator, the optimization trajectory will be different and have different results than <code>nlmixr</code>
</li>
</ol></li>
<li><p>Components of <code>omega</code> can now be fixed.</p></li>
<li><p>Residual error components can also be fixed.</p></li>
<li><p>When optimizing only one residual value, nlmixr2’s saem uses <code>nlm</code> from R, which is more efficient than the nealder-meade method.</p></li>
<li><p>Lower level <code>saem</code> functions (like <code>configsaem()</code>) are not exported because they are increasingly difficult to use and convert to something standard; a few methods (like <code>print</code>, <code>summary</code> etc) are maintained to view the lower level object and for debugging it.</p></li>
<li><p>Parameter history and print-out no longer includes fixed parameters.</p></li>
<li><p>The model to calculate the residuals more closely matches the model used for estimation to remove small rounding differences that may occur in the models.</p></li>
<li><p>Different types of additive and proportional errors can be used for each endpoint using <code>+ combined1()</code> or <code>+ combined2()</code> otherwise it takes the supplied <code>addProp</code> option to figure out which type of combined model is run (by default <code>combined2()</code>)</p></li>
<li><p>Parameter history and printout now uses standard deviation for additive only components, matching the estimation of the components.</p></li>
<li><p><code>rxode2</code> solving options are now saved in the <code>rxControl</code> part of the <code><a href="../reference/saemControl.html">saemControl()</a></code>. That is <code>saemControl(rxControl=rxControl(...))</code>; This fixes any conflicting option names as well as allowing alignment between the control structures in <code>focei</code>, <code>nlme</code> and <code>saem</code></p></li>
<li><p><code><a href="../reference/saemControl.html">saemControl()</a></code> aligned between other methods.</p></li>
</ul></div>
<div class="section level3">
<h3 id="nlme-changes-2-0-6">nlme changes<a class="anchor" aria-label="anchor" href="#nlme-changes-2-0-6"></a></h3>
<ul><li><p><code>nlme</code> has been completely rewritten to directly run from the <code>rxode2</code> UI</p></li>
<li><p><code>nlme</code> always tries to use mu-referencing (when available)</p></li>
<li><p>Internally <code>nlme</code> now uses parallel processing for solving so it should be faster.</p></li>
<li><p><code><a href="../reference/nlmixr2NlmeControl.html">nlmixr2NlmeControl()</a></code> (which will overwrite <code><a href="../reference/nlmixr2NlmeControl.html">nlmeControl()</a></code>) documents and adds more options to <code>nlme</code>. Also aligned with other methods.</p></li>
<li><p><code>weights</code>, <code>fixed</code>, <code>random</code> can be specified in <code><a href="../reference/nlmixr2NlmeControl.html">nlmixr2NlmeControl()</a></code>. If so, then the <code>nlme</code> object will be returned.</p></li>
<li><p><code>returnNlme</code> is a new option that will return the <code>nlme</code> object instead of the traditional <code>nlme</code> object.</p></li>
<li><p><code>nlme_ode</code> and <code>lme_lin_cmpt</code> are both removed.</p></li>
<li><p><code>rxode2</code> solving options are now saved in the <code>rxControl</code> part of the <code><a href="../reference/saemControl.html">saemControl()</a></code>. That is <code>nlmeControl(rxControl=rxControl(...))</code>; This fixes any conflicting option names as well as allowing alignment between the control structures in <code>focei</code>, <code>nlme</code> and <code>saem</code></p></li>
</ul></div>
<div class="section level3">
<h3 id="nlmixr2-object-change-2-0-6">nlmixr2 object change<a class="anchor" aria-label="anchor" href="#nlmixr2-object-change-2-0-6"></a></h3>
<ul><li><p>With <code>saem</code>, the nlmixr2 function now saves/compresses the <code>phiM</code> information. This means the gaussian and Laplacians likelihoods can be calculated when you save the nlmixr object and then restore it later.</p></li>
<li><p>The nlmixr2 object compresses infrequently used and removes many unneeded objects. Even with compression, the <code>saem</code> objects are often a bit bigger since they include the large <code>phiM</code> object.</p></li>
<li><p><code>nlmixr2</code> now supports non-mu referenced ETAs in the <code>fit$parFixed</code> and <code>fit$parFixedDf</code></p></li>
</ul></div>
<div class="section level3">
<h3 id="nlmixr2-interface-change-2-0-6">nlmixr2 interface change<a class="anchor" aria-label="anchor" href="#nlmixr2-interface-change-2-0-6"></a></h3>
<ul><li><p><code>nlmixr2</code> interface changed to use <code>rxode2</code> UI</p></li>
<li><p><code>keep</code> and <code>drop</code> are added to <code>tableControl</code> to influence the end data-frame</p></li>
<li><p><code>$simInfo</code> uses a quoted expression for <code>$rx</code> instead of a string</p></li>
<li><p><code>$simInfo$sigma</code> is a diagonal matrix since now the normal simulation is controlled by the variability modeled as a population value.</p></li>
<li><p><code>nlmixr2</code> now allows etas that have initial omega estimates of zero to be dropped from the model (instead of issuing an error about a non-positive definite <code>$omega</code> matrix)</p></li>
</ul></div>
<div class="section level3">
<h3 id="npde-changes-2-0-6">NPDE changes<a class="anchor" aria-label="anchor" href="#npde-changes-2-0-6"></a></h3>
<ul><li>Fixed a bug where the number of simulations for a NPDE calculation are correctly passed by <code>addNpde(fit, table=tableControl(nsim=500))</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="vpc-changes-2-0-6">VPC changes<a class="anchor" aria-label="anchor" href="#vpc-changes-2-0-6"></a></h3>
<ul><li><p><code>vpc</code> function rewritten and split out to <code><a href="../reference/vpcSim.html">vpcSim()</a></code> and <code>vpcPlot()</code> (which is a replacement for <code>vpc()</code>).</p></li>
<li><p>There were too many mismatches between <code>vpc::vpc</code> and <code>nlmixr::vpc</code> which caused inconsistencies in code based on load order of <code>vpc</code> and <code>nlmixr</code>. This way both coexist, and you can use the <code>vpc</code> simulation for other packages more easily (like <code>ggPMX</code>) without creating or summarizing data since <code>ggPMX</code> has its own methods for summarizing and creating plots.</p></li>
<li><p>VPC now directly uses <code><a href="https://nlmixr2.github.io/rxode2/reference/rxSolve.html" class="external-link">rxode2::rxSolve</a></code></p></li>
</ul></div>
<div class="section level3">
<h3 id="augpred-changes-2-0-6">augPred() changes<a class="anchor" aria-label="anchor" href="#augpred-changes-2-0-6"></a></h3>
<ul><li><p><code><a href="https://rdrr.io/pkg/nlme/man/augPred.html" class="external-link">augPred()</a></code> has been written to use the new fit object.</p></li>
<li><p><code>nlmixr2AugPred</code> was changed to <code><a href="../reference/nlmixr2AugPredSolve.html">nlmixr2AugPredSolve()</a></code></p></li>
<li><p><code>augPred</code> uses the new interface and supports multiple endpoints. The endpoint name is now always on the <code>plot(augPred(fit))</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="getfitmethod-change-2-0-6">getFitMethod() change<a class="anchor" aria-label="anchor" href="#getfitmethod-change-2-0-6"></a></h3>
<ul><li>Internally, fit estimation method is saved in <code>fit$est</code>, and now <code>getFitMethod(fit)</code> simply returns <code>fit$est</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="delete-methods-2-0-6">Delete methods<a class="anchor" aria-label="anchor" href="#delete-methods-2-0-6"></a></h3>
<ul><li><p>Many methods lower level utility functions have been deleted.</p></li>
<li><p><code>nmDocx</code>, <code>nmLst</code> and <code>nmSave</code> have been removed.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-2-0-6">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-0-6"></a></h3>
<ul><li>Now will reset the cache when items cannot be loaded. In the past error messages like <code>function   'rx_0ba247452048de33b1ffb8af516714fc__calc_lhs' not provided by   package 'rx_0ba247452048de33b1ffb8af516714fc_'</code> would cause the estimation to stop. Now <code><a href="https://nlmixr2.github.io/rxode2/reference/rxClean.html" class="external-link">rxode2::rxClean()</a></code> is run when this occurs.</li>
</ul></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler, Yuan Xiong, Rik Schoemaker, Justin Wilkins, Wenping Wang, Vipul Mann, Richard Hooijmaijers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

