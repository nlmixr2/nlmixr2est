<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Hessian — nlmixr2Hess • nlmixr2est</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Hessian — nlmixr2Hess"><meta name="description" content="Unlike `stats::optimHess` which assumes the gradient is accurate,
nlmixr2Hess does not make as strong an assumption that the gradient
is accurate but takes more function evaluations to calculate the
Hessian.  In addition, this procedures optimizes the forward
difference interval by nlmixr2Gill83"><meta property="og:description" content="Unlike `stats::optimHess` which assumes the gradient is accurate,
nlmixr2Hess does not make as strong an assumption that the gradient
is accurate but takes more function evaluations to calculate the
Hessian.  In addition, this procedures optimizes the forward
difference interval by nlmixr2Gill83"><meta property="og:image" content="https://nlmixr2.github.io/nlmixr2est/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nlmixr2est</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/nlmixr2est/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Hessian</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/nlmixr2est/blob/main/R/nlmixrGrad.R" class="external-link"><code>R/nlmixrGrad.R</code></a></small>
      <div class="d-none name"><code>nlmixr2Hess.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Unlike `stats::optimHess` which assumes the gradient is accurate,
nlmixr2Hess does not make as strong an assumption that the gradient
is accurate but takes more function evaluations to calculate the
Hessian.  In addition, this procedures optimizes the forward
difference interval by <code><a href="nlmixr2Gill83.html">nlmixr2Gill83</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nlmixr2Hess</span><span class="op">(</span><span class="va">par</span>, <span class="va">fn</span>, <span class="va">...</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>Initial values for the parameters to be optimized over.</p></dd>


<dt id="arg-fn">fn<a class="anchor" aria-label="anchor" href="#arg-fn"></a></dt>
<dd><p>A function to be minimized (or maximized), with first
   argument the vector of parameters over which minimization is to take
   place.  It should return a scalar result.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra arguments sent to <code><a href="nlmixr2Gill83.html">nlmixr2Gill83</a></code></p></dd>


<dt id="arg-envir">envir<a class="anchor" aria-label="anchor" href="#arg-envir"></a></dt>
<dd><p>an environment within which to evaluate the call.  This
    will be most useful if <code>what</code> is a character string and
    the arguments are symbols or quoted expressions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Hessian matrix based on Gill83</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If you have an analytical gradient function, you should use
`stats::optimHess`</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="nlmixr2Gill83.html">nlmixr2Gill83</a></code>, <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matthew Fidler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="va">func0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>  <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="fu">nlmixr2Hess</span><span class="op">(</span><span class="va">x</span>, <span class="va">func0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]        [,2]        [,3]        [,4]        [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 143438578824           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]            0 54098751870           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]            0           0 28167126506           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]            0           0           0 17234064451           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]            0           0           0           0 11620957271          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]            0           0           0           0           0 8362405349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]            0           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]            0           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]            0           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]            0           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]            0           0           0           0           0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,7]         [,8]         [,9]        [,10]    [,11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]            0            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 337177531807            0            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]            0 546113920621            0            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]            0            0 545713835656            0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]            0            0            0 337491323869     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]            0            0            0            0 26296.35</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>   <span class="co">## Rosenbrock Banana function</span></span></span>
<span class="r-in"><span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">grr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="co">## Gradient of 'fr'</span></span></span>
<span class="r-in"><span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">400</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       <span class="fl">200</span> <span class="op">*</span>      <span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">1.2</span><span class="op">)</span>, <span class="va">fr</span>, <span class="va">grr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">1.2</span><span class="op">)</span>, <span class="va">fr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## in this case h3 is closer to h1 where the gradient is known</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h3</span> <span class="op">&lt;-</span> <span class="fu">nlmixr2Hess</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">1.2</span><span class="op">)</span>, <span class="va">fr</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Fidler, Yuan Xiong, Rik Schoemaker, Justin Wilkins, Wenping Wang, Vipul Mann, Richard Hooijmaijers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

